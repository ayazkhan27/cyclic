import random
import string
import importlib.util
import sys
from decimal import Decimal, getcontext
import time
import math
from sympy import isprime

# Import the khan_encryption module from a specific path
module_name = "khan_encryption"
file_path = "C:/Users/admin/Downloads/khan_encryption.py"

spec = importlib.util.spec_from_file_location(module_name, file_path)
ke = importlib.util.module_from_spec(spec)
sys.modules[module_name] = ke
spec.loader.exec_module(ke)

# Define the cyclic primes and their respective sequences
cyclic_primes = {
    7: "142857",
    97: "010309278350515463917525773195876288659793814432989690721649484536082474226804123711340206185567",
    257: "0038910505836575875486381322957198443579766536964980544747081712062256809338521400778210116731517509727626459143968871595330739299610894941634241245136186770428015564202334630350194552529182879377431906614785992217898832684824902723735408560311284046692607",
    65537: "0000152585562354090055998901383951050551596807910035552436028502983047744022460594778522056243038283717594641195050124357233318583395639104627920106199551398446678975235363229931183911378305384744495475838076201229839632573965851351145154645467445870271754886552634389734043364816821032393914887773318888566763812808032104002319300547782168851183301036055968384271480232540397027633245342325709141401040633535254894181912507438546164761890229946442467613714390344385614233181256389520423577521094953995452950241848116331232738758258693562415124280940537406350611105177228130674275600042723957459145215679692387506294154447106214809954682087980835253368326288966537986175748050719440926499534614034820025329203350778949295817629735874391565070113065901704380731495185925507728458733234661336344355097120710438378320643300730884843676091368234737629125532142148709889070296168576529288798693867586248989120649404153379007278331324290095671147596014465111311167737308695851198559592291377389871370370935502082792926133329264385003890931840029296427971985290751789065718601705906587118726826067717472572745166852312434197476234798663350473778171109449623876588797168011962708088560660390313868501762363245189740146787310984634633870943131360910630636129209454201443459419869691929749607092176938218105802828936326044829638219631658452477226604818652059142163968445305705174176419427193798922745929780124204647756229305583105726536155148999801638768939682927201428200863634282924149716953781833162946122037932770801226787921326884050231167126966446434838335596685841585669163983703861940583182019317332194027801089460915208202999832155881410500938401208477653844393243511298960892320368646718647481575293345743625738132657887910645894685444863207043349558264796984909287883180493461708653127241100447075697697483864076781054976578116178647176404168637563513740329889985809542701069624792102171292552298701496864366693623449349222576559805911164685597448769397439614263698368860338434777301371744205563269603430123441719944458855303111219616399896241817599218761920747058913285624914170621175824343500617971527534064726795550605001754733967072035643987365915437081343363290965408853014327784305049056258296839953003646794940262752338373743076430108183163709049849703221081221294841082136808215206677144208614980850511924561697972137876314143155774600607290538169278422875627508125181195355295481941498695393441872530021209393167218517783847292369196026671956299494941788607961914643636419122022674214565817782321436745655126111967285655431283091993835543280894761737644384088377557715488960434563681584448479484871141492591970947708927781253337809176495719974975967773929230816180173032027709538123502754169400491325510780169980316462456322382776141721470314478844011779605413735752323115186841021102583273570654744648061400430291285838533957916901902741962555502998306300257869600378412194638143338877275432198605367960083616888170041350687397958405175702275050734699482734943619634710163724308405938630086821184979477241863374887468147763858583700810229336100218197354166348780078428979050002288783435311350839983520759265758273952118650533286540427544745716160336908921677830843645574255763919617925751865358499778750934586569418801592993270976700184628530448448967758670674580771167432137571143018447594488609487770267177319682011688054076323298289515846010650472252315485908723316599783328501457192120481560034789508216732532767749515540839525764072203488105955414498680134885637121015609503028823412728687611578192471428353449196637014205715855165784213497718845842806353662816424309931794253627721744968491081373880403436226864214108061095259166577658421960114134000640859361887178235195385812594412316706593222149320231319712528800524894334498069792636220760791613897493019210522300379938050261684239437264446038115873476051695988525565710972427788882615926880998519920045165326456810656575674809649510963272655141370523521064436882982132230648336054442528647939331980408013793734836809741062300685109174969864351435067213940216976669667516059630437767978393884370660848070555564032531241893891999938965775058363977600439446419579779361276835985779025588598806780902391015762088591177502784686512962143521979950257106672566641744358148831957520179440621328409905854708027526435448677846102201809664769519508064146970413659459541938141813021651891298045378946244106382654073271587042434044890672444573294474876787158399072279780887132459526679585577612646291407906983841188946701863069716343439583746585898042327234997024581534095243908021423012954514243862245754306727497444191830568991562018401818819903260753467506904496696522575033950287623785037459755557929108747730289759982910417016341913728123044997482338221157514076018127164807665898652669484413384805529700779712223629400186154386071989868318659688420281672948105650243373971954773639318247707401925629796908616506706135465462257961151715824648671742679707646062529563452706104948349787143140516044371881532569388284480522452965500404351740238338648397088667470283961731540961594213955475532905076521659520576163083449044051451851625799166882829546668294245998443627263988281428811205883699284373712559317637365152509269572913010970901933259075026321009506080534659810488731556220150449364481132795214916764575735843874452599295054701924103941285075606146146451622747455635747745548316218319422616232052123228100157163129224712757678868425469582068144712147336619009109358072539176343134412621877717930329432229122480430901628087950318140897508277766757709385537940400079344492424126829119428719654546286830340113218487266734821551184826891679509284831469246379907533149213421426064665761325663365732334406518455223766727192273067122388879564215633916718800067137647435799624639516608938462242702595480415643071852541312541007369882661702549704746936844835741642125822054717182660176694081206036284846727802615316538749103559821169720921006454369287578009368753528541129438332544974594503868044005676182919572150083159131482979080519401254253322550620260310969376077635534125761020492241024154294520652455864626089079451302317774692158627950623312022216457878755512153440041503272960312495231701176434685750034331751529670262599752811388986374109281779757999298106413171185742405053633825167462654683613836458794268886277980377496681264018798541282023894899064650502769427956726734516380060118711567511482063567145276713917329142316554007659795230175320811144849474342737690159757083784732288630849748996749927521857881807223400521842623250987991516242733112592886461083052321589331217480202023284556815234142545432351190930314173672887071425301737949555213085737827486763202465782687642095304942246364648976913804415826174527366220608206051543402963211620916428887498664876329401712010009612890428307673527930787188916184750598898332239803469795687932007873415017471046889543311411874208462395288157834505699070753925263591558966690571738102140775439827883485664586416833239238903214977798800677479896852159848635122144742664449089827120557852815966553244731983459725040816637929719089979706120206906022552146115934510276637624547965271526008209103254650045012740894456566519675908265559912721058333460487968628408379999084486625875459664006591696293696690419152539786685383828982101713535865236431328867662541770297694432152829699253856600088499626165372232479362802691609319926148587820620412896531730167691533027144971542792620962204556204891893129072127195324778369470680684193661595739811099073805636510673360086668599417123151807375986084196713306986892900193783664189694371118604757617834200527946045745151593756198788470634908524955368723011428658620321345194317713657933686314600912461662877458534873430276027282298548911302012603567450447838625509254314356775561896333368936631215954346399743656255245128705921845674962235073317362711140271907472114988479790042266200772082945511695683354441002792315791079848024779895326304225094221584753650609579321604589773715611028884446953629247600592031981933869417275737369730076140195614690937943451790591574225246807147107740665578222988540824267207836794482506065276103575079725956330012054259425973114423913209332132993576147824892808642446251735660771777774386987503242443200024413689976654408959824221432168088255489265605688389764560477287639043593695164563528998886125394815142591208019897157330973343302256740467216991928223751468636037658116788989425820528861559119276134092192196774341211834536216183224743274791339243480781848421502357446938370691365183026382043731022170682210049285136640371088087645147016189328165768954941483436837206463524421319254772113462624166501365640783069106001190167386361902436791430794818194302455101698277309001022323267772403375192639272472038695698612997238201321390969986419884950485985016097776828356500907884096006835833193463234508750782001007064711536994369592749134076933640538932206234646077788119688115110548239925538245571204052672536124631887330820757739902650411218090544272700917039229748081236553397317545813815096815539313670140531302928116941574988174618917558020660085142743793582251247386972244686207791018813799838259303904664540641164533011886415307383615362314417809786837969391336191769534766620382379419259349680333246868181332682301600622549094404687428475517646520286250514976272945053938996292170834795611639226696369989471596197567786136075804507377511939820254207546881914033294169705662450218960281978119230358423485969757541541419350901017745700901780673512672230953507179150708759937134748310114896928452629812167172742115141065352396356256770984329462746234951248912827868227108351007827639348764819872743640996688893296916245784823839968262203030349268352228512138181485267863954712605093306071379526069243328196286067412301448036986740314631429574133695469734653707066237392617910493309123090773151044448174313746433312479973144941025680150144193356424615102918961807833742771258983474983597052046935318980118101225262065703343149671178113126935929322367517585486061308878953873384500358576071532111631597418252284968796252498588583548224666982010162198452782397729526832171139966736347406808367792239498298670979751895875612249568945786349695591803103590338282191739017654149564368219479072890123136548819750675191113416848497795138623983398690815875001907319529426125699986267299388131894960098875444405450356287288096800280757434731525703037978546469933014938126554465416482292445488807849001327494392480583487190442040374139798892228817309306193447975952515372995407174573141889314433068343073378396936081907929871675542060210262904923936097166486107084547660100401300028991256847277110639791262950699604803393502906754962845415566779071364267513007919190686177273906342981827059523627874330530845171429879304820177914765704869005294719013686924943161878023101454140409234478233669530189053511756717579382638814715351633428445000534049468239315195996154843828676930588827685124433526099760440667104078612081724827196850633993011581244182675435250316615041884736866197720371698429894563376413323771304759143689824068846605734165433266704304438714008880479729008041259136060545951142102934220364069151776858873613378702107206616109983673344828112364008117551917237590979141553626195889344950180813891389596716358698139981994903642217373392129636693776034911576666615804812548636648000366205349649816134397363321482521323832338984085325846468407159314585653905427468452934983291880922227138868120298457359964600149533851107008254878923356272029540564871751834841387307932923386789142011382882951615118177518043242748371149121870088652211727726322535361704075560370477745395730655965332560233150739277049605566321314677205242839922486534324122251552558096952866319788821581701939362497520484611746036590017852510795428536551871461922272914536826525474159635015334849016586050627889589087080580435479194958573019820864549796298274257289775241466652425347513618261440102537497901948517631261730015105970673054915543891237011154004608083983093519691166821795321726658223598883073683568060790088041869478309962311366098539756168271358164090513755588446221218548300959763187207226452233089705052107969543921754123624822619283763370309901277141156903733768710804583670293116865282206997573889558569968109617467995178296229610754230434716267146802569540870042876543021499305735691288890245204998703022719990234524009338236416070311427132764697804293757724644094175809084944382562521934174588400445549842073942963516792041137067610662679097303813113203228710499412545584936753284404229671788455376352289546363123121290263515266185513526710102690083464302607687260631399057021224651723453926789447182507591131727115980285945343851564764941941193524268733692418023406625265117414590231472298091154614950333399453743686772357599523933045455239025283427682072722279017959320689076399591070692891038649922944291011184521720554801104719471443612005432046019805605993560889268657399636846361597265666722614706196499687199597174115385202252162900346369226543784427117506141568884752124753955780704029784701771518378930985550147245067671696904038939835512763782290919633184308100767505378641072981674473961273784274531943787478828753223370004730152432976791735965942902482567099501045211102125516883592474480064696278438134183743534186795245433877046553855074232876085264812243465523292186093351847048232296260127866701252727466927079359750980362238125028609792941391885499794009490821978424401483131666081755344309321452004211361520972885545569678197048995224071898316981247234386682332117735019912415887208752307856630605612096983383432259639592901719639287730594931107618597128339716496025146100675954041228618948075133130903153943573859041457497291606268214901506019500434868852709156659596868944260494072050902543601324442681233501686070464012695118787860292659108595144727405892854418114957962677571448189572302668721485573035079420785205303874147428170346521812106138517173505042952835802676350763690739582220730274501426675008010742023589727939942322657430153958832415276866502891496406610006561179181225872407952759509895173718662740131528754749225628271052992965805575476448418450646199856569571387155347361032699086012481499000564566580710133207195935120618887040908189267131544013305461037276652883104200680531608099241649755100172421685460121763278758563864687123304392938340174252712208370843950745380472099729923554633260600881944550406640523673649999237072188229549720005493080244747242015960449822237819857485084761279887697026107389718784808581412026794024749378213833407083021804476860399469002243007766605123823183850344080443108473076277522620809618993850801837130170743244274226772662770648641225567236828051329783175915894838030425561133405557166180935959839479988403497261089155744083494819720158078642598837298014861833773288371454292994796832323725529090437462807269176190548850267787661931428048278071928834093718052397882112394525230022735248790759418343836306208706532187924378595297312968246944474113859346628621999786380212704273921601538062468529227764468925950226589560095823733158368555167310069121259746402795367502326929825899873353983246105253520911851320628042174649434670491478096342524070372461357706333826693318278224514396447808108396783496345575781619543158826311854372339289256450554648519157117353556006530662068755054396752979233104963608343378549521644262019927674443444161313456520744007202038543113050643148145322489586035369333353678074980545340799853517860140073546241054671406991470467064406365869661412637136274165738437829012618826006683247631109144452751880617056014159940186459557196698048430657491188183774051299266063445076826830645284343195446846819353952728992782702900651540351251964539115308909470985855318369775851808901841707737613866975906739704289180157773471474129117902864031005386270351099378976761218853472084471367319224255000991806155301585363992858995681828585379251415231090834185269389810336145993866060393365579748844164365167767825808322016570792071654180081480690297084089903413339029860994552695423958985000839220592947495307993957611730778033782443505195538398156766406762592123533271281871309336710560446770526572775683964783252208676015075453560584097532691456734363794497764621511512580679616094725117109419106764117979156812182431298350550070952286494651876039489143537238506492515678166531882753253887117200970444176572012756153012801928681508155698307826113493141278972183651982849382791400277705723484443901918000518790912003906190396264705433571875429146894120878282496910142362329676366022246974991226330164639821780063170422814593283183545172955734928361078474754718708515800234981766025298686238308131284617849459084181454750751483894593893525794589315958923966614278956925095747440377191510139310618429284221126996963547309153607885621862459374094023223522590292506523032790637349893953034163907411080763538154019866640218502525291056960190426781817904389886628927170911088392816271724369440163571722843584540030822283595526191311778079558112211422555197827181592077757602575644292537040145261455361093733310954117521400125120161130353845919099134839861452309382486229152997543372446099150098417687718388086119291392648427605779941101972931321238384424065794894487083632146726276759692997848543570807330210415490486290187222485008468498710651998107939026809283305613622839006973160199581915559149793246563010207974121488624746326502586325281901826449181378457970306849565894075102613790683125562659261180707081495948853319498909013229168256099607855104749988556082823443245800082396203671208630239406747333567297862276271419198315455391610845781772128721180401910371240673207501106245327067152905992035033645116499076857347757755161206646627096144162839312144284907762027556952561148664113401589941559729618383508552420769946747638738422570456383417001083357492714039397592199826052458916337336161252422295802371179638982559470222927506599325571814394921952484855882936356561942109037642858232754016814928971420724171078932511405770785968231685917878450341028731861391275157544593130597982818865678929459694523704167111707890199429329996795703190564108824023070937027938416467033889253398843401437355997375528327509651036818896196041930512534903947388498100309748691578802813677769809420632619741520057372171445137861055586920365595007400399774173367715946717121625951752445183636724293147382394677815585089338846758319727787356760303340097959931031325815951294688496574454125150678242824663930298915116651662419701847811160108030578146695759647222179837343790530540000305171124708180111997802767902101103193615820071104872057005966095488044921189557044112486076567435189282390100248714466637166791278209255840212399102796893357950470726459862367822756610769488990951676152402459679265147931702702290309290934891740543509773105268779468086729633642064787829775546637777133527625616064208004638601095564337702366602072111936768542960465080794055266490684651418282802081267070509788363825014877092329523780459892884935227428780688771228466362512779040847155042189907990905900483696232662465477516517387124830248561881074812701222210354456261348551200085447914918290431359384775012588308894212429619909364175961670506736652577933075972351496101438881852999069228069640050658406701557898591635259471748783130140226131803408761462990371851015456917466469322672688710194241420876756641286601461769687352182736469475258251064284297419778140592337153058577597387735172497978241298808306758014556662648580191342295192028930222622335474617391702397119184582754779742740741871004165585852266658528770007781863680058592855943970581503578131437203411813174237453652135434945145490333704624868394952469597326700947556342218899247753177594336023925416177121320780627737003524726490379480293574621969269267741886262721821261272258418908402886918839739383859499214184353876436211605657872652089659276439263316904954453209637304118284327936890611410348352838854387597845491859560248409295512458611166211453072310297999603277537879365854402856401727268565848299433907563666325892244075865541602453575842653768100462334253932892869676671193371683171338327967407723881166364038634664388055602178921830416405999664311762821001876802416955307688786487022597921784640737293437294963150586691487251476265315775821291789370889726414086699116529593969818575766360986923417306254482200894151395394967728153562109953156232357294352808337275127027480659779971619085402139249584204342585104597402993728733387246898698445153119611822329371194897538794879228527396737720676869554602743488411126539206860246883439888917710606222439232799792483635198437523841494117826571249828341242351648687001235943055068129453591101210003509467934144071287974731830874162686726581930817706028655568610098112516593679906007293589880525504676747486152860216366327418099699406442162442589682164273616430413354288417229961701023849123395944275752628286311549201214581076338556845751255016250362390710590963882997390786883745060042418786334437035567694584738392053343912598989883577215923829287272838244045348429131635564642873491310252223934571310862566183987671086561789523475288768176755115430977920869127363168896958969742282985183941895417855562506675618352991439949951935547858461632360346064055419076247005508338800982651021560339960632924912644765552283442940628957688023559210827471504646230373682042205166547141309489296122800860582571677067915833803805483925111005996612600515739200756824389276286677754550864397210735920167233776340082701374795916810351404550101469398965469887239269420327448616811877260173642369958954483726749774936295527717167401620458672200436394708332697560156857958100004577566870622701679967041518531516547904237301066573080855089491432320673817843355661687291148511527839235851503730716999557501869173138837603185986541953400369257060896897935517341349161542334864275142286036895188977218975540534354639364023376108152646596579031692021300944504630971817446633199566657002914384240963120069579016433465065535499031081679051528144406976211910828997360269771274242031219006057646825457375223156384942856706898393274028411431710331568426995437691685612707325632848619863588507255443489936982162747760806872453728428216122190518333155316843920228268001281718723774356470390771625188824633413186444298640462639425057601049788668996139585272441521583227794986038421044600759876100523368478874528892076231746952103391977051131421944855577765231853761997039840090330652913621313151349619299021926545310282741047042128873765964264461296672108885057295878663960816027587469673619482124601370218349939728702870134427880433953339335032119260875535956787768741321696141111128065062483787783999877931550116727955200878892839159558722553671971558051177197613561804782031524177182355005569373025924287043959900514213345133283488716297663915040358881242656819811709416055052870897355692204403619329539039016128293940827318919083876283626043303782596090757892488212765308146543174084868089781344889146588949753574316798144559561774264919053359171155225292582815813967682377893403726139432686879167493171796084654469994049163068190487816042846025909028487724491508613454994888383661137983124036803637639806521506935013808993393045150067900575247570074919511115858217495460579519965820834032683827456246089994964676442315028152036254329615331797305338968826769611059401559424447258800372308772143979736637319376840563345896211300486747943909547278636495414803851259593817233013412270930924515922303431649297343485359415292125059126905412209896699574286281032088743763065138776568961044905931000808703480476677296794177334940567923463081923188427910951065810153043319041152326166898088102903703251598333765659093336588491996887254527976562857622411767398568747425118635274730305018539145826021941803866518150052642019012161069319620977463112440300898728962265590429833529151471687748905198590109403848207882570151212292292903245494911271495491096632436638845232464104246456200314326258449425515357736850939164136289424294673238018218716145078352686268825243755435860658864458244960861803256175900636281795016555533515418771075880800158688984848253658238857439309092573660680226436974533469643102369653783359018569662938492759815066298426842852129331522651326731464668813036910447533454384546134244777759128431267833437600134275294871599249279033217876924485405190960831286143705082625082014739765323405099409493873689671483284251644109434365320353388162412072569693455605230633077498207119642339441842012908738575156018737507057082258876665089949189007736088011352365839144300166318262965958161038802508506645101240520621938752155271068251522040984482048308589041304911729252178158902604635549384317255901246624044432915757511024306880083006545920624990463402352869371500068663503059340525199505622777972748218563559515998596212826342371484810107267650334925309367227672917588537772555960754993362528037597082564047789798129301005538855913453469032760120237423135022964127134290553427834658284633108015319590460350641622289698948685475380319514167569464577261699497993499855043715763614446801043685246501975983032485466225185772922166104643178662434960404046569113630468285090864702381860628347345774142850603475899110426171475654973526404931565375284190609884492729297953827608831652349054732441216412103086805926423241832857774997329752658803424020019225780856615347055861574377832369501197796664479606939591375864015746830034942093779086622823748416924790576315669011398141507850527183117933381143476204281550879655766971329172833666478477806429955597601354959793704319697270244289485328898179654241115705631933106489463966919450081633275859438179959412240413812045104292231869020553275249095930543052016418206509300090025481788913133039351816531119825442116666920975937256816759998168973251750919328013183392587393380838305079573370767657964203427071730472862657735325083540595388864305659398507713200176999252330744464958725605383218639852297175641240825793063460335383066054289943085585241924409112409783786258144254390649556738941361368387323191479622198147611273021346720173337198834246303614751972168393426613973785800387567328379388742237209515235668401055892091490303187512397576941269817049910737446022857317240642690388635427315867372629201824923325754917069746860552054564597097822604025207134900895677251018508628713551123792666737873262431908692799487312510490257411843691349924470146634725422280543814944229976959580084532401544165891023391366708882005584631582159696049559790652608450188443169507301219158643209179547431222057768893907258495201184063963867738834551474739460152280391229381875886903581183148450493614294215481331156445977081648534415673588965012130552207150159451912660024108518851946228847826418664265987152295649785617284892503471321543555548773975006484886400048827379953308817919648442864336176510978531211376779529120954575278087187390329127057997772250789630285182416039794314661946686604513480934433983856447502937272075316233577978851641057723118238552268184384393548682423669072432366449486549582678486961563696843004714893876741382730366052764087462044341364420098570273280742176175290294032378656331537909882966873674412927048842638509544226925248333002731281566138212002380334772723804873582861589636388604910203396554618002044646535544806750385278544944077391397225994476402642781939972839769900971970032195553656713001815768192013671666386926469017501564002014129423073988739185498268153867281077864412469292155576239376230221096479851076491142408105345072249263774661641515479805300822436181088545401834078459496162473106794635091627630193631078627340281062605856233883149976349237835116041320170285487587164502494773944489372415582037627599676518607809329081282329066023772830614767230724628835619573675938782672383539069533240764758838518699360666493736362665364603201245098188809374856951035293040572501029952545890107877992584341669591223278453392739978943192395135572272151609014755023879640508415093763828066588339411324900437920563956238460716846971939515083082838701802035491401803561347025344461907014358301417519874269496620229793856905259624334345484230282130704792712513541968658925492469902497825655736454216702015655278697529639745487281993377786593832491569647679936524406060698536704457024276362970535727909425210186612142759052138486656392572134824602896073973480629262859148267390939469307414132474785235820986618246181546302088896348627492866624959946289882051360300288386712849230205837923615667485542517966949967194104093870637960236202450524131406686299342356226253871858644735035170972122617757907746769000717152143064223263194836504569937592504997177167096449333964020324396905564795459053664342279933472694813616735584478996597341959503791751224499137891572699391183606207180676564383478035308299128736438958145780246273097639501350382226833696995590277247966797381631750003814639058852251399972534598776263789920197750888810900712574576193600561514869463051406075957092939866029876253108930832964584890977615698002654988784961166974380884080748279597784457634618612386895951905030745990814349146283778628866136686146756793872163815859743351084120420525809847872194332972214169095320200802600057982513694554221279582525901399209606787005813509925690831133558142728535026015838381372354547812685963654119047255748661061690342859758609640355829531409738010589438027373849886323756046202908280818468956467339060378107023513435158765277629430703266856890001068098936478630391992309687657353861177655370248867052199520881334208157224163449654393701267986023162488365350870500633230083769473732395440743396859789126752826647542609518287379648137693211468330866533408608877428017760959458016082518272121091902284205868440728138303553717747226757404214413232219967346689656224728016235103834475181958283107252391778689900361627782779193432717396279963989807284434746784259273387552069823153333231609625097273296000732410699299632268794726642965042647664677968170651692936814318629171307810854936905869966583761844454277736240596914719929200299067702214016509757846712544059081129743503669682774615865846773578284022765765903230236355036086485496742298243740177304423455452645070723408151120740955490791461311930665120466301478554099211132642629354410485679844973068648244503105116193905732639577643163403878724995040969223492073180035705021590857073103742923844545829073653050948319270030669698033172101255779178174161160870958389917146039641729099592596548514579550482933304850695027236522880205074995803897035262523460030211941346109831087782474022308009216167966187039382333643590643453316447197766147367136121580176083738956619924622732197079512336542716328181027511176892442437096601919526374414452904466179410104215939087843508247249645238567526740619802554282313807467537421609167340586233730564413995147779117139936219234935990356592459221508460869432534293605139081740085753086042998611471382577780490409997406045439980469048018676472832140622854265529395608587515449288188351618169888765125043868349176800891099684147885927033584082274135221325358194607626226406457420998825091169873506568808459343576910752704579092726246242580527030532371027053420205380166928605215374521262798114042449303446907853578894365015182263454231960571890687703129529883882387048537467384836046813250530234829180462944596182309229900666798907487373544715199047866090910478050566855364145444558035918641378152799182141385782077299845888582022369043441109602209438942887224010864092039611211987121778537314799273692723194531333445229412392999374399194348230770404504325800692738453087568854235012283137769504249507911561408059569403543036757861971100294490135343393808077879671025527564581839266368616201535010757282145963348947922547568549063887574957657506446740009460304865953583471931885804965134199002090422204251033767184948960129392556876268367487068373590490867754093107710148465752170529624486931046584372186703694096464592520255733402505454933854158719501960724476250057219585882783770999588018981643956848802966263332163510688618642904008422723041945771091139356394097990448143796633962494468773364664235470039824831774417504615713261211224193966766864519279185803439278575461189862215237194256679432992050292201351908082457237896150266261806307887147718082914994583212536429803012039000869737705418313319193737888520988144101805087202648885362467003372140928025390237575720585318217190289454811785708836229915925355142896379144605337442971146070158841570410607748294856340693043624212277034347010085905671605352701527381479164441460549002853350016021484047179455879884645314860307917664830553733005782992813220013122358362451744815905519019790347437325480263057509498451256542105985931611150952896836901292399713139142774310694722065398172024962998001129133161420266414391870241237774081816378534263088026610922074553305766208401361063216198483299510200344843370920243526557517127729374246608785876680348505424416741687901490760944199459847109266521201763889100813281047347299998474144376459099440010986160489494484031920899644475639714970169522559775394052214779437569617162824053588049498756427666814166043608953720798938004486015533210247646367700688160886216946152555045241619237987701603674260341486488548453545325541297282451134473656102659566351831789676060851122266811114332361871919678959976806994522178311488166989639440316157285197674596029723667546576742908585989593664647451058180874925614538352381097700535575323862856096556143857668187436104795764224789050460045470497581518836687672612417413064375848757190594625936493888948227718693257243999572760425408547843203076124937058455528937851900453179120191647466316737110334620138242519492805590735004653859651799746707966492210507041823702641256084349298869340982956192685048140744922715412667653386636556449028792895616216793566992691151563239086317652623708744678578512901109297038314234707112013061324137510108793505958466209927216686757099043288524039855348886888322626913041488014404077086226101286296290644979172070738666707356149961090681599707035720280147092482109342813982940934128812731739322825274272548331476875658025237652013366495262218288905503761234112028319880372919114393396096861314982376367548102598532126890153653661290568686390893693638707905457985565405801303080702503929078230617818941971710636739551703617803683415475227733951813479408578360315546942948258235805728062010772540702198757953522437706944168942734638448510001983612310603170727985717991363657170758502830462181668370538779620672291987732120786731159497688328730335535651616644033141584143308360162961380594168179806826678059721989105390847917970001678441185894990615987915223461556067564887010391076796313532813525184247066542563742618673421120893541053145551367929566504417352030150907121168195065382913468727588995529243023025161359232189450234218838213528235958313624364862596701100141904572989303752078978287074477012985031356333063765506507774234401940888353144025512306025603857363016311396615652226986282557944367303965698765582800555411446968887803836001037581824007812380792529410867143750858293788241756564993820284724659352732044493949982452660329279643560126340845629186566367090345911469856722156949509437417031600469963532050597372476616262569235698918168362909501502967789187787051589178631917847933228557913850191494880754383020278621236858568442253993927094618307215771243724918748188046447045180585013046065581274699787906068327814822161527076308039733280437005050582113920380853563635808779773257854341822176785632543448738880327143445687169080061644567191052382623556159116224422845110395654363184155515205151288585074080290522910722187466621908235042800250240322260707691838198269679722904618764972458305995086744892198300196835375436776172238582785296855211559882203945862642476768848131589788974167264293452553519385995697087141614660420830980972580374444970016936997421303996215878053618566611227245678013946320399163831118299586493126020415948242977249492653005172650563803652898362756915940613699131788150205227581366251125318522361414162991897706638997818026458336512199215710209499977112165646886491600164792407342417260478813494667134595724552542838396630910783221691563544257442360803820742481346415002212490654134305811984070067290232998153714695515510322413293254192288325678624288569815524055113905122297328226803179883119459236767017104841539893495277476845140912766834002166714985428078795184399652104917832674672322504844591604742359277965118940445855013198651143628789843904969711765872713123884218075285716465508033629857942841448342157865022811541571936463371835756900682057463722782550315089186261195965637731357858919389047408334223415780398858659993591406381128217648046141874055876832934067778506797686802874711994751056655019302073637792392083861025069807894776996200619497383157605627355539618841265239483040114744342890275722111173840731190014800799548346735431893434243251903504890367273448586294764789355631170178677693516639455574713520606680195919862062651631902589376993148908250301356485649327860597830233303324839403695622320216061156293391519294444359674687581061080000610342249416360223995605535804202206387231640142209744114011932190976089842379114088224972153134870378564780200497428933274333582556418511680424798205593786715900941452919724735645513221538977981903352304804919358530295863405404580618581869783481087019546210537558936173459267284129575659551093275554267055251232128416009277202191128675404733204144223873537085920930161588110532981369302836565604162534141019576727650029754184659047560919785769870454857561377542456932725025558081694310084379815981811800967392465324930955033034774249660497123762149625402444420708912522697102400170895829836580862718769550025176617788424859239818728351923341013473305155866151944702992202877763705998138456139280101316813403115797183270518943497566260280452263606817522925980743702030913834932938645345377420388482841753513282573202923539374704365472938950516502128568594839556281184674306117155194775470344995956482597616613516029113325297160382684590384057860445244670949234783404794238369165509559485481483742008331171704533317057540015563727360117185711887941163007156262874406823626348474907304270869890290980667409249736789904939194653401895112684437798495506355188672047850832354242641561255474007049452980758960587149243938538535483772525443642522544516837816805773837679478767718998428368707752872423211315745304179318552878526633809908906419274608236568655873781222820696705677708775195690983719120496818591024917222332422906144620595999206555075758731708805712803454537131696598867815127332651784488151731083204907151685307536200924668507865785739353342386743366342676655934815447762332728077269328776111204357843660832811999328623525642003753604833910615377572974045195843569281474586874589926301173382974502952530631551642583578741779452828173398233059187939637151532721973846834612508964401788302790789935456307124219906312464714588705616674550254054961319559943238170804278499168408685170209194805987457466774493797396890306239223644658742389795077589758457054793475441353739109205486976822253078413720493766879777835421212444878465599584967270396875047682988235653142499656682484703297374002471886110136258907182202420007018935868288142575949463661748325373453163861635412057311137220196225033187359812014587179761051009353494972305720432732654836199398812884324885179364328547232860826708576834459923402047698246791888551505256572623098402429162152677113691502510032500724781421181927765994781573767490120084837572668874071135389169476784106687825197979767154431847658574545676488090696858263271129285746982620504447869142621725132367975342173123579046950577536353510230861955841738254726337793917939484565970367883790835711125013351236705982879899903871095716923264720692128110838152494011016677601965302043120679921265849825289531104566885881257915376047118421654943009292460747364084410333094282618978592245601721165143354135831667607610967850222011993225201031478401513648778552573355509101728794421471840334467552680165402749591833620702809100202938797930939774478538840654897233623754520347284739917908967453499549872591055434334803240917344400872789416665395120313715916200009155133741245403359934083037063033095808474602133146161710178982864641347635686711323374582297023055678471703007461433999115003738346277675206371973083906800738514121793795871034682698323084669728550284572073790377954437951081068709278728046752216305293193158063384042601889009261943634893266399133314005828768481926240139158032866930131070998062163358103056288813952423821657994720539542548484062438012115293650914750446312769885713413796786548056822863420663136853990875383371225414651265697239727177014510886979873964325495521613744907456856432244381036666310633687840456536002563437447548712940781543250377649266826372888597280925278850115202099577337992279170544883043166455589972076842089201519752201046736957749057784152463493904206783954102262843889711155530463707523994079680180661305827242626302699238598043853090620565482094084257747531928528922593344217770114591757327921632055174939347238964249202740436699879457405740268855760867906678670064238521751071913575537482643392282222256130124967575567999755863100233455910401757785678319117445107343943116102354395227123609564063048354364710011138746051848574087919801028426690266566977432595327830080717762485313639623418832110105741794711384408807238659078078032256587881654637838167752567252086607565192181515784976425530616293086348169736179562689778293177899507148633596289119123548529838106718342310450585165631627935364755786807452278865373758334986343592169308939988098326136380975632085692051818056975448983017226909989776767322275966248073607275279613043013870027617986786090300135801150495140149839022231716434990921159039931641668065367654912492179989929352884630056304072508659230663594610677937653539222118803118848894517600744617544287959473274638753681126691792422600973495887819094557272990829607702519187634466026824541861849031844606863298594686970718830584250118253810824419793399148572562064177487526130277553137922089811862001617406960953354593588354669881135846926163846376855821902131620306086638082304652333796176205807406503196667531318186673176983993774509055953125715244823534797137494850237270549460610037078291652043883607733036300105284038024322138639241954926224880601797457924531180859667058302943375497810397180218807696415765140302424584585806490989822542990982193264873277690464928208492912400628652516898851030715473701878328272578848589346476036437432290156705372537650487510871721317728916489921723606512351801272563590033111067030837542151761600317377969696507316477714878618185147321360452873949066939286204739307566718037139325876985519630132596853685704258663045302653462929337626073820895066908769092268489555518256862535666875200268550589743198498558066435753848970810381921662572287410165250164029479530646810198818987747379342966568503288218868730640706776324824145139386911210461266154996414239284678883684025817477150312037475014114164517753330179898378015472176022704731678288600332636525931916322077605017013290202481041243877504310542136503044081968964096617178082609823458504356317805209271098768634511802493248088865831515022048613760166013091841249980926804705738743000137327006118681050399011245555945496437127119031997192425652684742969620214535300669850618734455345835177075545111921509986725056075194165128095579596258602011077711826906938065520240474846270045928254268581106855669316569266216030639180920701283244579397897370950760639028335138929154523398995986999710087431527228893602087370493003951966064970932450371545844332209286357324869920808093138227260936570181729404763721256694691548285701206951798220852342951309947052809863130750568381219768985458595907655217663304698109464882432824206173611852846483665715549994659505317606848040038451561713230694111723148755664739002395593328959213879182751728031493660069884187558173245647496833849581152631338022796283015701054366235866762286952408563101759311533942658345667332956955612859911195202709919587408639394540488578970657796359308482231411263866212978927933838900163266551718876359918824480827624090208584463738041106550498191861086104032836413018600180050963577826266078703633062239650884233333841951874513633519996337946503501838656026366785174786761676610159146741535315928406854143460945725315470650167081190777728611318797015426400353998504661488929917451210766437279704594351282481651586126920670766132108579886171170483848818224819567572516288508781299113477882722736774646382959244396295222546042693440346674397668492607229503944336786853227947571600775134656758777484474419030471336802111784182980606375024795153882539634099821474892045714634481285380777270854631734745258403649846651509834139493721104109129194195645208050414269801791354502037017257427102247585333475746524863817385598974625020980514823687382699848940293269450844561087629888459953919160169064803088331782046782733417764011169263164319392099119581305216900376886339014602438317286418359094862444115537787814516990402368127927735477669102949478920304560782458763751773807162366296900987228588430962662312891954163297068831347177930024261104414300318903825320048217037703892457695652837328531974304591299571234569785006942643087111097547950012969772800097654759906617635839296885728672353021957062422753559058241909150556174374780658254115995544501579260570364832079588629323893373209026961868867967712895005874544150632467155957703282115446236477104536368768787097364847338144864732898973099165356973923127393686009429787753482765460732105528174924088682728840197140546561484352350580588064757312663075819765933747348825854097685277019088453850496666005462563132276424004760669545447609747165723179272777209820406793109236004089293071089613500770557089888154782794451988952805285563879945679539801943940064391107313426003631536384027343332773852938035003128004028258846147977478370996536307734562155728824938584311152478752460442192959702152982284816210690144498527549323283030959610601644872362177090803668156918992324946213589270183255260387262157254680562125211712467766299952698475670232082640340570975174329004989547888978744831164075255199353037215618658162564658132047545661229534461449257671239147351877565344767078139066481529517677037398721332987472725330729206402490196377618749713902070586081145002059905091780215755985168683339182446556906785479957886384790271144544303218029510047759281016830187527656133176678822649800875841127912476921433693943879030166165677403604070982803607122694050688923814028716602835039748538993240459587713810519248668690968460564261409585425027083937317850984939804995651311472908433404031310557395059279490974563986755573187664983139295359873048812121397073408914048552725941071455818850420373224285518104276973312785144269649205792147946961258525718296534781878938614828264949570471641973236492363092604177792697254985733249919892579764102720600576773425698460411675847231334971085035933899934388208187741275920472404901048262813372598684712452507743717289470070341944245235515815493538001434304286128446526389673009139875185009994354334192898667928040648793811129590918107328684559866945389627233471168957993194683919007583502448998275783145398782367212414361353128766956070616598257472877916291560492546195279002700764453667393991180554495933594763263500007629278117704502799945069197552527579840395501777621801425149152387201123029738926102812151914185879732059752506217861665929169781955231396005309977569922333948761768161496559195568915269237224773791903810061491981628698292567557257732273372293513587744327631719486702168240841051619695744388665944428338190640401605200115965027389108442559165051802798419213574011627019851381662267116285457070052031676762744709095625371927308238094511497322123380685719517219280711659062819476021178876054747699772647512092405816561636937912934678120756214047026870317530555258861406533713780002136197872957260783984619375314707722355310740497734104399041762668416314448326899308787402535972046324976730701741001266460167538947464790881486793719578253505653295085219036574759296275386422936661733066817217754856035521918916032165036544242183804568411736881456276607107435494453514808428826464439934693379312449456032470207668950363916566214504783557379800723255565558386865434792559927979614568869493568518546775104139646306666463219250194546592001464821398599264537589453285930085295329355936341303385873628637258342615621709873811739933167523688908555472481193829439858400598135404428033019515693425088118162259487007339365549231731693547156568045531531806460472710072172970993484596487480354608846910905290141446816302241481910981582922623861330240932602957108198422265285258708820971359689946137296489006210232387811465279155286326807757449990081938446984146360071410043181714146207485847689091658147306101896638540061339396066344202511558356348322321741916779834292079283458199185193097029159100965866609701390054473045760410149991607794070525046920060423882692219662175564948044616018432335932374078764667287181286906632894395532294734272243160352167477913239849245464394159024673085432656362055022353784884874193203839052748828905808932358820208431878175687016494499290477135053481239605108564627614935074843218334681172467461128827990295558234279872438469871980713184918443016921738865068587210278163480171506172085997222942765155560980819994812090879960938096037352945664281245708531058791217175030898576376703236339777530250087736698353601782199368295771854067168164548270442650716389215252452812914841997650182339747013137616918687153821505409158185452492485161054061064742054106840410760333857210430749042525596228084898606893815707157788730030364526908463921143781375406259059767764774097074934769672093626501060469658360925889192364618459801333597814974747089430398095732181820956101133710728290889116071837282756305598364282771564154599691777164044738086882219204418877885774448021728184079222423974243557074629598547385446389062666890458824785998748798388696461540809008651601385476906175137708470024566275539008499015823122816119138807086073515723942200588980270686787616155759342051055129163678532737232403070021514564291926697895845095137098127775149915315012893480018920609731907166943863771609930268398004180844408502067534369897920258785113752536734974136747180981735508186215420296931504341059248973862093168744373407388192929185040511466805010909867708317439003921448952500114439171765567541999176037963287913697605932526664327021377237285808016845446083891542182278712788195980896287593267924988937546729328470940079649663548835009231426522422448387933533729038558371606878557150922379724430474388513358865984100584402703816164914475792300532523612615774295436165829989166425072859606024078001739475410836626638387475777041976288203610174405297770724934006744281856050780475151441170636434380578909623571417672459831850710285792758289210674885942292140317683140821215496589712681386087248424554068694020171811343210705403054762958328882921098005706700032042968094358911759769290629720615835329661107466011565985626440026244716724903489631811038039580694874650960526115018996902513084211971863222301905793673802584799426278285548621389444130796344049925996002258266322840532828783740482475548163632757068526176053221844149106611532416802722126432396966599020400689686741840487053115034255458748493217571753360697010848833483375802981521888398919694218533042403527778201626562094694599996948288752918198880021972320978988968063841799288951279429940339045119550788104429558875139234325648107176098997512855333628332087217907441597876008972031066420495292735401376321772433892305110090483238475975403207348520682972977096907090651082594564902268947312205319132703663579352121702244533622228664723743839357919953613989044356622976333979278880632314570395349192059447335093153485817171979187329294902116361749851229076704762195401071150647725712193112287715336374872209591528449578100920090940995163037673375345224834826128751697514381189251872987777896455437386514487999145520850817095686406152249874116911057875703800906358240383294932633474220669240276485038985611181470009307719303599493415932984421014083647405282512168698597738681965912385370096281489845430825335306773273112898057585791232433587133985382303126478172635305247417489357157025802218594076628469414224026122648275020217587011916932419854433373514198086577048079710697773776645253826082976028808154172452202572592581289958344141477333414712299922181363199414071440560294184964218685627965881868257625463478645650548545096662953751316050475304026732990524436577811007522468224056639760745838228786792193722629964752735096205197064253780307307322581137372781787387277415810915971130811602606161405007858156461235637883943421273479103407235607366830950455467903626958817156720631093885896516471611456124021545081404397515907044875413888337885469276897020003967224621206341455971435982727314341517005660924363336741077559241344583975464241573462318995376657460671071303233288066283168286616720325922761188336359613653356119443978210781695835940003356882371789981231975830446923112135129774020782153592627065627050368494133085127485237346842241787082106291102735859133008834704060301814242336390130765826937455177991058486046050322718464378900468437676427056471916627248729725193402200283809145978607504157956574148954025970062712666127531013015548468803881776706288051024612051207714726032622793231304453972565115888734607931397531165601110822893937775607672002075163648015624761585058821734287501716587576483513129987640569449318705464088987899964905320658559287120252681691258373132734180691822939713444313899018874834063200939927064101194744953232525138471397836336725819003005935578375574103178357263835695866457115827700382989761508766040557242473717136884507987854189236614431542487449837496376092894090361170026092131162549399575812136655629644323054152616079466560874010101164227840761707127271617559546515708683644353571265086897477760654286891374338160123289134382104765247112318232448845690220791308726368311030410302577170148160581045821444374933243816470085600500480644521415383676396539359445809237529944916611990173489784396600393670750873552344477165570593710423119764407891725284953537696263179577948334528586905107038771991394174283229320841661961945160748889940033873994842607992431756107237133222454491356027892640798327662236599172986252040831896485954498985306010345301127607305796725513831881227398263576300410455162732502250637044722828325983795413277995636052916673024398431420418999954224331293772983200329584814684834520957626989334269191449105085676793261821566443383127088514884721607641484962692830004424981308268611623968140134580465996307429391031020644826586508384576651357248577139631048110227810244594656453606359766238918473534034209683079786990554953690281825533668004333429970856157590368799304209835665349344645009689183209484718555930237880891710026397302287257579687809939423531745426247768436150571432931016067259715885682896684315730045623083143872926743671513801364114927445565100630178372522391931275462715717838778094816668446831560797717319987182812762256435296092283748111753665868135557013595373605749423989502113310038604147275584784167722050139615789553992401238994766315211254711079237682530478966080229488685780551444222347681462380029601599096693470863786868486503807009780734546897172589529578711262340357355387033278911149427041213360391839724125303263805178753986297816500602712971298655721195660466606649678807391244640432122312586783038588888719349375162122160001220684498832720447991211071608404412774463280284419488228023864381952179684758228176449944306269740757129560400994857866548667165112837023360849596411187573431801882905839449471291026443077955963806704609609838717060591726810809161237163739566962174039092421075117872346918534568259151319102186551108534110502464256832018554404382257350809466408288447747074171841860323176221065962738605673131208325068282039153455300059508369318095121839571539740909715122755084913865450051116163388620168759631963623601934784930649861910066069548499320994247524299250804888841417825045394204800341791659673161725437539100050353235576849718479637456703846682026946610311732303889405984405755527411996276912278560202633626806231594366541037886995132520560904527213635045851961487404061827669865877290690754840776965683507026565146405847078749408730945877901033004257137189679112562369348612234310389550940689991912965195233227032058226650594320765369180768115720890489341898469566809588476738331019118970962967484016662343409066634115080031127454720234371423775882326014312525748813647252696949814608541739780581961334818499473579809878389306803790225368875596991012710377344095701664708485283122510948014098905961517921174298487877077070967545050887285045089033675633611547675358957535437996856737415505744846422631490608358637105757053267619817812838549216473137311747562445641393411355417550391381967438240993637182049834444664845812289241191998413110151517463417611425606909074263393197735630254665303568976303462166409814303370615072401849337015731571478706684773486732685353311869630895524665456154538657552222408715687321665623998657247051284007507209667821230755145948090391687138562949173749179852602346765949005905061263103285167157483558905656346796466118375879274303065443947693669225017928803576605581579870912614248439812624929429177411233349100508109922639119886476341608556998336817370340418389611974914933548987594793780612478447289317484779590155179516914109586950882707478218410973953644506156827440987533759555670842424889756931199169934540793750095365976471306284999313364969406594748004943772220272517814364404840014037871736576285151898927323496650746906327723270824114622274440392450066374719624029174359522102018706989944611440865465309672398797625768649770358728657094465721653417153668919846804095396493583777103010513145246196804858324305354227383005020065001449562842363855531989563147534980240169675145337748142270778338953568213375650395959534308863695317149091352976181393716526542258571493965241008895738285243450264735950684346247158093901155072707020461723911683476509452675587835878969131940735767581671422250026702473411965759799807742191433846529441384256221676304988022033355203930604086241359842531699650579062209133771762515830752094236843309886018584921494728168820666188565237957184491203442330286708271663335215221935700444023986450402062956803027297557105146711018203457588842943680668935105360330805499183667241405618200405877595861879548957077681309794467247509040694569479835817934906999099745182110868669606481834688801745578833330790240627431832400018310267482490806719868166074126066191616949204266292323420357965729282695271373422646749164594046111356943406014922867998230007476692555350412743946167813601477028243587591742069365396646169339457100569144147580755908875902162137418557456093504432610586386316126768085203778018523887269786532798266628011657536963852480278316065733860262141996124326716206112577627904847643315989441079085096968124876024230587301829500892625539771426827593573096113645726841326273707981750766742450829302531394479454354029021773959747928650991043227489814913712864488762073332621267375680913072005126874895097425881563086500755298533652745777194561850557700230404199154675984558341089766086332911179944153684178403039504402093473915498115568304926987808413567908204525687779422311060927415047988159360361322611654485252605398477196087706181241130964188168515495063857057845186688435540229183514655843264110349878694477928498405480873399758914811480537711521735813357340128477043502143827151074965286784564444512260249935151135999511726200466911820803515571356638234890214687886232204708790454247219128126096708729420022277492103697148175839602056853380533133954865190655660161435524970627279246837664220211483589422768817614477318156156064513175763309275676335505134504173215130384363031569952851061232586172696339472359125379556586355799014297267192578238247097059676213436684620901170331263255870729511573614904557730747516669972687184338617879976196652272761951264171384103636113950897966034453819979553534644551932496147214550559226086027740055235973572180600271602300990280299678044463432869981842318079863283336130735309824984359979858705769260112608145017318461327189221355875307078444237606237697789035201489235088575918946549277507362253383584845201946991775638189114545981659215405038375268932053649083723698063689213726597189373941437661168500236507621648839586798297145124128354975052260555106275844179623724003234813921906709187176709339762271693852327692753711643804263240612173276164609304667592352411614813006393335062636373346353967987549018111906251430489647069594274989700474541098921220074156583304087767215466072600210568076048644277278483909852449761203594915849062361719334116605886750995620794360437615392831530280604849169171612981979645085981964386529746555380929856416985824801257305033797702061430947403756656545157697178692952072874864580313410745075300975021743442635457832979843447213024703602545127180066222134061675084303523200634755939393014632955429757236370294642720905747898133878572409478615133436074278651753971039260265193707371408517326090605306925858675252147641790133817538184536979111036513725071333750400537101179486396997116132871507697941620763843325144574820330500328058959061293620397637975494758685933137006576437737461281413552649648290278773822420922532309992828478569357767368051634954300624074950028228329035506660359796756030944352045409463356577200665273051863832644155210034026580404962082487755008621084273006088163937928193234356165219646917008712635610418542197537269023604986496177731663030044097227520332026183682499961853609411477486000274654012237362100798022491111890992874254238063994384851305369485939240429070601339701237468910691670354151090223843019973450112150388330256191159192517204022155423653813876131040480949692540091856508537162213711338633138532432061278361841402566489158795794741901521278056670277858309046797991973999420174863054457787204174740986007903932129941864900743091688664418572714649739841616186276454521873140363458809527442513389383096571402413903596441704685902619894105619726261501136762439537970917191815310435326609396218929764865648412347223705692967331431099989319010635213696080076903123426461388223446297511329478004791186657918427758365503456062987320139768375116346491294993667699162305262676045592566031402108732471733524573904817126203518623067885316691334665913911225719822390405419839174817278789080977157941315592718616964462822527732425957855867677800326533103437752719837648961655248180417168927476082213100996383722172208065672826037200360101927155652532157407266124479301768466667683903749027267039992675893007003677312052733570349573523353220318293483070631856813708286921891450630941300334162381555457222637594030852800707997009322977859834902421532874559409188702564963303172253841341532264217159772342340967697636449639135145032577017562598226955765445473549292765918488792590445092085386880693348795336985214459007888673573706455895143201550269313517554968948838060942673604223568365961212750049590307765079268199642949784091429268962570761554541709263469490516807299693303019668278987442208218258388391290416100828539603582709004074034514854204495170666951493049727634771197949250041961029647374765399697880586538901689122175259776919907838320338129606176663564093565466835528022338526328638784198239162610433800753772678029204876634572836718189724888231075575629033980804736255855470955338205898957840609121564917527503547614324732593801974457176861925324625783908326594137662694355860048522208828600637807650640096434075407784915391305674657063948609182599142469139570013885286174222195095900025939545600195309519813235271678593771457344706043914124845507118116483818301112348749561316508231991089003158521140729664159177258647786746418053923737735935425790011749088301264934311915406564230892472954209072737537574194729694676289729465797946198330713947846254787372018859575506965530921464211056349848177365457680394281093122968704701161176129514625326151639531867494697651708195370554038176907700993332010925126264552848009521339090895219494331446358545554419640813586218472008178586142179227001541114179776309565588903977905610571127759891359079603887880128782214626852007263072768054686665547705876070006256008056517692295954956741993072615469124311457649877168622304957504920884385919404305964569632421380288997055098646566061919221203289744724354181607336313837984649892427178540366510520774524314509361124250423424935532599905396951340464165280681141950348658009979095777957489662328150510398706074431237316325129316264095091322459068922898515342478294703755130689534156278132963059035354074797442665974945450661458412804980392755237499427804141172162290004119810183560431511970337366678364893113813570959915772769580542289088606436059020095518562033660375055312266353357645299601751682255824953842867387887758060332331354807208141965607214245388101377847628057433205670079497077986480919175427621038497337381936921128522819170850054167874635701969879609991302622945816866808062621114790118558981949127973511146375329966278590719746097624242794146817828097105451882142911637700840746448571036208553946625570288539298411584295893922517051436593069563757877229656529899140943283946472984726185208355585394509971466499839785159528205441201153546851396920823351694462669942170071867799868776416375482551840944809802096525626745197369424905015487434578940140683888490471031630987076002868608572256893052779346018279750370019988708668385797335856081297587622259181836214657369119733890779254466942337915986389367838015167004897996551566290797564734424828722706257533912141233196514945755832583120985092390558005401528907334787982361108991867189526527"
}

def generate_cyclic_sequence(prime):
    # Get the length of the cyclic sequence
    length = len(cyclic_primes[prime])
    getcontext().prec = length + 10  # Set precision to required length + buffer
    return cyclic_primes[prime]

def get_user_input(cyclic_prime):
    # User input for starting dial position
    start_position = int(input(f"User 1: Enter the starting dial position (integer between 1 and {cyclic_prime - 1}): "))

    # User input for superposition sequence (must be an even integer)
    while True:
        superposition_sequence_length = int(input("User 2: Enter the superposition sequence length (even integer): "))
        if superposition_sequence_length % 2 == 0:
            break
        else:
            print("Superposition sequence length must be an even integer. Please try again.")

    return start_position, superposition_sequence_length

def measure_khan_encryption(plaintext, start_position, superposition_sequence_length, cyclic_prime, cyclic_sequence):
    # Calculate z_value
    z_value = superposition_sequence_length - 1

    # Encrypt the plaintext
    start_time = time.time()
    ciphertext, char_to_movement, movement_to_char, z_value, superposition_sequence, iv, salt, z_layers = ke.khan_encrypt(plaintext, cyclic_prime, cyclic_sequence, start_position)
    encryption_time = time.time() - start_time

    # Decrypt the ciphertext
    start_time = time.time()
    decrypted_text = ke.khan_decrypt(ciphertext, char_to_movement, movement_to_char, z_value, superposition_sequence, iv, salt, z_layers, cyclic_prime, start_position, cyclic_sequence)
    decryption_time = time.time() - start_time

    return encryption_time, decryption_time

def main():
    for cyclic_prime in cyclic_primes.keys():
        cyclic_sequence = generate_cyclic_sequence(cyclic_prime)
        key_size = math.ceil(math.log2(cyclic_prime))  # Calculate the key size based on the cyclic prime
        start_position, superposition_sequence_length = get_user_input(cyclic_prime)
        plaintext = ke.generate_plaintext(128)
        encryption_time, decryption_time = measure_khan_encryption(plaintext, start_position, superposition_sequence_length, cyclic_prime, cyclic_sequence)
        security_level_bits = key_size  # Security level equals the key size in this case

        # Display results
        print("\nCyclic Prime:", cyclic_prime)
        print("Cyclic Sequence:", cyclic_sequence)
        print("Key Size:", key_size, "bits")
        print("Security Level (in bits):", security_level_bits)
        print("Encryption Time:", encryption_time, "seconds")
        print("Decryption Time:", decryption_time, "seconds")

        # Wait for user input before exiting
        input("Press Enter to exit...")

if __name__ == "__main__":
    main()
